<html>
	<head>
		<meta charset="UTF-8">
		<script>
			var conversion_list = { 
					length: [
					{imp: "inches",si: "meters", convert: function(x) {0.0254*x;}},	
       				 	{imp: "feet",si: "meters", convert: function(x) {0.3048*x;}},	
       				 	{imp: "yards",si: "meters", convert: function(x) {0.9144*x;}},
				 	{imp: "miles",si: "meters", convert: function(x) {1609.34*x;}}
				 ],
       				 volume: 
				 [
				 	{imp: "teaspoons",si: "liters", convert: function(x) {0.004929*x;}},
       				 	{imp: "tablespoons",si: "liters", convert: function(x) {0.01479*x;}},
       		       		 	{imp: "fluid ounces",si: "liters", convert: function(x) {0.02957*x;}},
       				 	{imp: "cups",si: "liters", convert: function(x) {0.2366*x;}},
       				 	{imp: "pints",si: "liters", convert: function(x) {0.4732*x;}},
       				 	{imp: "quarts",si: "liters", convert: function(x) {0.9464*x;}},
       				 	{imp: "gallons",si: "liters", convert: function(x) {3.785*x;}}
				 ],
       				 weight: 
				 [
				 	{imp: "ounces",si: "grams", convert: function(x) {28.35*x;}},
       				 	{imp: "pounds",si: "grams", convert: function(x) {453.6*x;}},
       				 	{imp: "tons",si: "grams", convert: function(x) {907185*x;}}
				 ],
       				 temperature: 
				 [
				 	{imp: "fahrenheit",si: "Â°c", convert: function(x) {(x-32)*(5.0/9);}}
       		     ],
       				 speed: 
				 [
 				 	{imp: "mph",si: "kph", convert: function(x) {1.609*x;}}
				 ]
       		         };

			//Reset everything! 2 textboxes, three selectors
			function ResetValues() {
				console.log("checkpoint 1");
				var a = document.getElementById("categories");
				a.value = "All";
				document.getElementById("input").value="";
				document.getElementById("output").value="";
				console.log("checkpoint 2");
				var imperial = document.getElementById("imperialContainer");
				var metric = document.getElementById("metricContainer");
				imperial.innerHTML = ""; metric.innerHTML = "";
				console.log("checkpoint 3");
				console.log(Object.keys(conversion_list).length);
				var len = Object.keys(conversion_list).length;
				for(var i=0; i<len; i++)
				{
					console.log("checkpoint 4");
					var metricEntry = document.createElement("option");
					var val = conversion_list[conversion_list.keys(i)][0].si;
					console.log("what?!");
					metricEntry.value = val; metricEntry.text = val;
					console.log("hey");
					metric.add(metricEntry);
					//lem = conversion_list[i].length;
					console.log(Object.keys(conversion_list[i]).length);
					lem = Object.keys(conversion_list[i]).length;
					for(var t=0; t<lem; t++)
					{
						console.log("checkpoint 5");
						var temp = document.createElement("option");
						var val = conversion_list[i][t].imp;
						temp.value = val; temp.text = val;
						imperial.add(val);
					}
					console.log("checkpoint 6");
				}
				console.log("checkpoint 7");
			}

			function updateContainers() {
				var empire = document.getElementById("imperialContainer");
				var meter = document.getElementById("metricContainer");
				var cats = document.getElementById("categories");
				if(cats.value=="All")
				{
					resetValues();
				}
				else 
				{
					empire.innerHTML = "";
					meter.innerHTML = "";
					var len = conversion_list[cats.value]
					for(var i = 0; i<len; i++)
					{
						var temp = document.createElement("option");
						var val = conversion_list[cats.value][i].imp;
						temp.value = val; temp.text = val;
						empire.add(val);
					}
					var temp = document.createElement("option");
					var val = conversion_list[cats.value][0].imp;
					temp.value = val; temp.text = val;
					meter.add(val);
				}
			}

			function updateFromInput()
			{
				var empire = document.getElementById("imperialContainer");
				var meter = document.getElementById("metricContainer");
				var value = empire.value;
				var  len = conversion_list.length;
				for(var i = 0; i<len; i++)
					{
						var lent = conversion_list[i].length;
						for(var t =0; i<lent; i++)
						{
							if(conversion_list[i][t][imp]===value)
							{
								meter.value = conversion_list[i][t][si];
								return;
							}
						}
					}
			}

			function calculate()
			{
				var empire = document.getElementById("imperialContainer");
				var empVal = empire.value;
				var si = document.getElementById("output");

				var stringToInt = parseFloat(this.value);
				var len = conversion_list.length;
				for(var i = 0; i<len; i++)
					{
						var  lent = conversion_list[i].length;
						for(var t =0; i<lent; i++)
						{
							if(conversion_list[i][t][imp]===value)
							{
								output.value = conversion_list[i][t].convert(empVal);
								return;
							}
						}
					}
			}

			

		</script>

	</head>
	<body>

		
		<input type="text" id="input" onchange="calculate(this)"> </input> <input type="text" id="output" readonly> </input>
		<select id="categories" onchange="updateContainers()">
			<option value="All">--</option>
			<option value="length">Length</option>
			<option value="volume">Volume</option>
			<option value="weight">Weight</option>
			<option value="temperature">temperature</option>
			<option value="speed">speed</option>
			 
		</select> 
		<select id="imperialContainer" onchange="updateFromInput()">
			
		</select>
		<select id="metricContainer">

		</select>

		<script>document.addEventListener('DOMContentLoaded',function(){ResetValues()});</script>
	</body>
</html>
